import o from"./TopBar.51894da2.js";import n from"./Container.f87d9f62.js";import l from"./Content.e22a1fd6.js";import c from"./Page.3927bdbf.js";import p from"./PageHeader.a5f457a5.js";import d from"./PageHeaderTitle.3ed783af.js";import m from"./PageBody.dec1fae1.js";import u from"./Button.f17dffc9.js";import _ from"./List.d5d221b1.js";import b from"./ListItem.ee1e88fb.js";import f from"./StatusBubble.4f1d8322.js";import h from"./NotificationBadge.b6fae3d5.js";import v from"./MainLayout.39e63d2b.js";import g from"./IconBox.e6c961ac.js";import y from"./IconGlobe.07030b80.js";import C from"./IconStorage.ef2b2e41.js";import x from"./IconArrowUp.5ed32d30.js";import T from"./IconArrowDown.defeed18.js";import w from"./IconClose.edb7c8fd.js";import B from"./Modal.a59fc373.js";import I from"./ModalContainer.51de3ea9.js";import S from"./FormInput.e3b01057.js";import $ from"./FormSelect.9822372e.js";import H from"./FormTextarea.5b8e3d32.js";import A from"./FormActions.83ccca91.js";import D from"./Table.5d32c28c.js";import k from"./TableHead.1eed799b.js";import F from"./TableHeader.44bdf327.js";import N from"./TableRow.6382a60a.js";import U from"./TableBody.c78326a3.js";import z from"./TableData.c69a64ca.js";import{u as j}from"./notification.f3a0f54e.js";import{u as a}from"./confirm.bae7aa90.js";import{n as E}from"./plugin-vue2_normalizer.000ba15c.js";import"./TopBar.f6a175cb.js";import"./Dropdown.d1060583.js";import"./DropdownList.02c48c2f.js";import"./DropdownListItem.ac31464c.js";import"./IconMoon.ade3e41b.js";import"./IconSun.8809e5d7.js";import"./IconSearch.27dac870.js";import"./IconButton.eadc8d3d.js";import"./Breadcrumbs.d39e2491.js";import"./BreadcrumbsItem.da3f8155.js";import"./TopBarTabBarContainer.3bdb2bb3.js";import"./TabBar.c1d45ed5.js";import"./TabBarItem.e9886f0a.js";import"./Confirm.888708f1.js";import"./Notification.d432029f.js";import"./IconDanger.2f6e115d.js";import"./IconWarning.ca92fb65.js";import"./IconSuccess.09b85716.js";import"./IconInfo.ad7662f9.js";import"./SearchPalette.282fdde5.js";import"./app.0131bc0c.js";import"./Form.2cdcadd9.js";import"./FormGroup.efd02a6a.js";import"./Label.9d0d3ee0.js";import"./ErrorText.b141a597.js";import"./HelperText.14a7ed0b.js";import"./IconClipboard.8551be1b.js";import"./IconKey.455a255f.js";const R={metaInfo(){return{title:`${this.__("Billing")}`}},layout:v,components:{TopBar:o,Container:n,Content:l,Page:c,PageHeader:p,PageHeaderTitle:d,PageBody:m,Button:u,List:_,ListItem:b,StatusBubble:f,NotificationBadge:h,IconBox:g,IconGlobe:y,IconStorage:C,IconArrowDown:T,IconArrowUp:x,IconClose:w,Modal:B,ModalContainer:I,FormInput:S,FormSelect:$,FormTextarea:H,FormActions:A,Table:D,TableHead:k,TableHeader:F,TableRow:N,TableBody:U,TableData:z},props:{packages:Array,countries:Object,subscription:[Object,null],public_key:String,data_client_secret:String,card:Object,filters:Object,ends:String},data(){return{sending:!1,clientSecret:this.data_client_secret,stripe:null,cardElement:null,cardHolderName:this.$page.props.auth.user.name,currentCardLastFour:this.card.last_four,currentCardBrand:this.card.brand,coupon:"",address:this.$page.props.auth.user.address,country:this.$page.props.auth.user.country,zip:this.$page.props.auth.user.zip,city:this.$page.props.auth.user.city,invoices:[],breadcrumbs:[{title:this.$page.props.settings.name,to:"/"},{title:this.__("Billing"),to:this.route("profile.billing.index")}]}},mounted(){const s=Stripe(this.public_key);this.stripe=s;const t=s.elements().create("card");t.mount("#card-element"),this.cardElement=t,this.getInvoices()},watch:{sending:function(s){s?this.cardElement.update({disabled:!0}):this.cardElement.update({disabled:!1})}},methods:{useNotification:j,useConfirm:a,async updateBilling(){this.sending=!0;const{setupIntent:s,error:e}=await this.stripe.confirmCardSetup(this.clientSecret,{payment_method:{card:this.cardElement,billing_details:{name:this.cardHolderName,address:{line1:this.address,postal_code:this.zip,city:this.city,country:this.country}}}});if(e)this.sending=!1,this.useNotification({variant:"danger",title:this.__("Error"),message:e.message});else{const t=s.payment_method;this.$inertia.post(this.route("profile.billing.update.card"),{payment_method:t,billing_details:{name:this.cardHolderName,address:{line1:this.address,postal_code:this.zip,city:this.city,country:this.country}}},{onStart:()=>this.sending=!0,onFinish:()=>this.sending=!1})}},updatePlan(s){a({title:this.__("Are you sure?"),message:this.__("Are you ready to subscribe to this plan? If you have any coupon codes, make sure to enter them before subscribing."),variant:"info",onConfirm:()=>{this.$inertia.post(this.route("profile.billing.update.plan"),{plan:s,coupon:this.coupon},{onStart:()=>this.sending=!0,onFinish:()=>this.sending=!1})}})},confirmCancel(){a({title:this.__("Are you sure?"),message:this.__("Your subscription will be put to an end. An expire date will be send to you when your plan expires."),onConfirm:()=>this.cancel()})},cancel(){this.$inertia.delete(this.route("profile.billing.cancel.plan"),{onStart:()=>this.sending=!0,onFinish:()=>this.sending=!1})},getInvoices(){window.axios.get(this.route("profile.billing.invoices")).then(s=>this.invoices=s.data)},requestFilterUrl(s){this.$inertia.visit(route("profile.billing.index",s),{only:["filters","packages"]})},deleteCard(){a({title:this.__("Are you sure?"),message:this.__("Are you sure you want to remove your card from your account? New payments will not be able to process."),onConfirm:()=>{this.$inertia.delete(route("profile.billing.delete.card"),{onStart:()=>{this.sending=!0},onFinish:()=>{this.sending=!1,this.currentCardLastFour=null}})}})}}};var L=function(){var e=this,t=e._self._c;return t("Page",[t("TopBar",{attrs:{breadcrumbs:e.breadcrumbs}}),t("Content",[t("Container",[t("PageBody",[t("div",{staticClass:"grid grid-cols-1 md:grid-cols-5 gap-8"},[t("div",{staticClass:"md:col-span-2 space-y-4"},[e.ends?t("div",{staticClass:"space-y-4 border-b border-low-emphasis pb-4"},[t("h2",{staticClass:"text-lg text-medium-emphasis"},[e._v(e._s(e.__("Subscription")))]),t("p",[e._v(" Renews on "+e._s(e.ends)+" ")])]):e._e(),t("h2",{staticClass:"text-lg text-medium-emphasis"},[e._v(e._s(e.__("Card information")))]),t("form",{staticClass:"space-y-4",on:{submit:function(r){return r.preventDefault(),e.updateBilling.apply(null,arguments)}}},[e.currentCardLastFour?t("div",{staticClass:"border-b border-low-emphasis pb-4 space-y-2"},[t("p",[e._v(" \xB7\xB7\xB7\xB7\xA0\xB7\xB7\xB7\xB7\xA0\xB7\xB7\xB7\xB7\xA0 "+e._s(e.currentCardLastFour)+" ("+e._s(e.currentCardBrand)+") ")]),t("Button",{attrs:{size:"sm",loading:e.sending,variant:"danger",type:"button"},on:{click:e.deleteCard}},[e._v(" "+e._s(e.__("Remove card"))+" ")])],1):e._e(),t("form-input",{attrs:{errors:e.$page.props.errors.card_holder_name,disabled:e.sending,id:"card-holder-name",label:e.__("Card holder name")},model:{value:e.cardHolderName,callback:function(r){e.cardHolderName=r},expression:"cardHolderName"}}),t("form-input",{attrs:{errors:e.$page.props.errors.address,disabled:e.sending,label:e.__("Address")},model:{value:e.address,callback:function(r){e.address=r},expression:"address"}}),t("form-select",{attrs:{disabled:e.sending,label:e.__("Country"),errors:e.$page.props.errors.country},model:{value:e.country,callback:function(r){e.country=r},expression:"country"}},e._l(e.countries,function(r,i){return t("option",{domProps:{value:i,textContent:e._s(r)}})}),0),t("form-input",{attrs:{errors:e.$page.props.errors.zip,disabled:e.sending,label:e.__("ZIP (postal code)")},model:{value:e.zip,callback:function(r){e.zip=r},expression:"zip"}}),t("form-input",{attrs:{errors:e.$page.props.errors.city,disabled:e.sending,label:e.__("City")},model:{value:e.city,callback:function(r){e.city=r},expression:"city"}}),t("div",{staticClass:"w-full pb-4"},[t("label",{staticClass:"form-label",attrs:{for:"card-element"}},[e._v(e._s(e.__("Card details")))]),t("div",{staticClass:"form-input",attrs:{id:"card-element"}})]),t("Button",{attrs:{"data-secret":e.clientSecret,id:"card-button",loading:e.sending,type:"submit"}},[e._v(" "+e._s(e.__("Save"))+" ")]),e.subscription?t("Button",{attrs:{loading:e.sending,variant:"danger",type:"button"},on:{click:e.confirmCancel}},[e._v(" "+e._s(e.__("Cancel"))+" ")]):e._e()],1)]),e.packages.length?e._e():t("div",{staticClass:"md:col-span-3 space-y-8"},[t("div",{staticClass:"bg-primary text-on-primary px-4 py-3 rounded relative space-y-2",attrs:{role:"alert"}},[t("strong",{staticClass:"font-bold"},[e._v("No packages available.")]),t("p",{staticClass:"block"},[e._v(" There are currently no packages to choose from. If you're and administrator, you can attach packages via the administrator area. ")])])]),e.packages.length?t("div",{staticClass:"md:col-span-3 space-y-8"},[t("h2",{staticClass:"text-lg text-medium-emphasis"},[e._v(e._s(e.__("Available packages")))]),t("form-input",{staticClass:"pb-4",attrs:{errors:e.$page.props.errors.coupon,disabled:e.sending,placeholder:e.__("Enter a coupon code if you have one, before subscribing"),label:e.__("Coupon")},model:{value:e.coupon,callback:function(r){e.coupon=r},expression:"coupon"}}),t("Table",{attrs:{caption:"Package list overview"}},[t("TableHead",[t("TableRow",[t("TableHeader",[t("a",{staticClass:"text-primary flex items-center space-x-2",attrs:{href:"javascript:void(0);","data-balloon-blunt":"","aria-label":e.__("Sort by name"),"data-balloon-pos":"up"},on:{click:function(r){return e.requestFilterUrl({sortBy:{name:e.filters.sort.name==="asc"?"desc":"asc"}})}}},[t("span",[e._v(e._s(e.__("Name")))]),e.filters.sort.name==="asc"?t("IconArrowUp"):e._e(),e.filters.sort.name==="desc"?t("IconArrowDown"):e._e()],1)]),t("TableHeader",[t("a",{staticClass:"text-primary flex items-center space-x-2",attrs:{href:"javascript:void(0);","data-balloon-blunt":"","aria-label":e.__("Sort by maximum sites"),"data-balloon-pos":"up"},on:{click:function(r){return e.requestFilterUrl({sortBy:{sites:e.filters.sort.sites==="asc"?"desc":"asc"}})}}},[t("span",[e._v(e._s(e.__("Max sites")))]),e.filters.sort.sites==="asc"?t("IconArrowUp"):e._e(),e.filters.sort.sites==="desc"?t("IconArrowDown"):e._e()],1)]),t("TableHeader",[t("a",{staticClass:"text-primary flex items-center space-x-2",attrs:{href:"javascript:void(0);","data-balloon-blunt":"","aria-label":e.__("Sort by maximum servers"),"data-balloon-pos":"up"},on:{click:function(r){return e.requestFilterUrl({sortBy:{servers:e.filters.sort.servers==="asc"?"desc":"asc"}})}}},[t("span",[e._v(e._s(e.__("Max servers")))]),e.filters.sort.servers==="asc"?t("IconArrowUp"):e._e(),e.filters.sort.servers==="desc"?t("IconArrowDown"):e._e()],1)]),t("TableHeader",[t("a",{staticClass:"text-primary flex items-center space-x-2",attrs:{href:"javascript:void(0);","data-balloon-blunt":"","aria-label":e.__("Sort by price"),"data-balloon-pos":"up"},on:{click:function(r){return e.requestFilterUrl({sortBy:{price:e.filters.sort.price==="asc"?"desc":"asc"}})}}},[t("span",[e._v(e._s(e.__("Price")))]),e.filters.sort.price==="asc"?t("IconArrowUp"):e._e(),e.filters.sort.price==="desc"?t("IconArrowDown"):e._e()],1)]),t("TableHeader",[t("inertia-link",{attrs:{href:e.route("profile.billing.index"),"data-balloon-blunt":"","aria-label":e.__("Clear sorting"),"data-balloon-pos":"up"}},[t("IconClose")],1)],1)],1)],1),t("TableBody",e._l(e.packages,function(r){return t("TableRow",{key:r.id},[t("TableData",[e._v(e._s(r.name))]),t("TableData",[e._v(e._s(r.maximum_sites===0?"Unlimited":r.maximum_sites)+" ")]),t("TableData",[e._v(e._s(r.maximum_servers===0?"Unlimited":r.maximum_servers)+" ")]),r.period==="monthly"?t("TableData",[e._v(e._s(r.price_monthly)+" p/month ")]):r.period==="yearly"?t("TableData",[e._v(e._s(r.price_yearly)+" yearly ")]):e._e(),t("TableData",{staticClass:"text-right"},[t("Button",{attrs:{size:"sm",disabled:e.sending||e.subscription&&r.plan_id===e.subscription.stripe_plan},on:{click:function(i){return e.updatePlan(r.id)}}},[e._v(" "+e._s(e.__("Subscribe"))+" ")])],1)],1)}),1)],1)],1):e._e(),t("div",{staticClass:"md:col-span-5 space-y-8 border-t border-low-emphasis"},[e.invoices.length?t("h2",{staticClass:"mt-5 text-lg text-medium-emphasis"},[e._v(e._s(e.__("Invoices")))]):e._e(),e.invoices.length?t("Table",{attrs:{caption:"Invoice list overview"}},[t("TableHead",[t("TableRow",[t("TableHeader",[e._v(e._s(e.__("Number")))]),t("TableHeader",[e._v(e._s(e.__("Status")))]),t("TableHeader",[e._v(e._s(e.__("Total")))]),t("TableHeader",[e._v(e._s(e.__("Date")))]),t("TableHeader")],1)],1),t("TableBody",e._l(e.invoices,function(r){return t("TableRow",{key:r.id},[t("TableData",[e._v(e._s(r.number))]),t("TableData",[e._v(e._s(r.status))]),t("TableData",[e._v(e._s(r.total))]),t("TableData",[e._v(e._s(r.created))]),t("TableData",[t("a",{staticClass:"text-primary",attrs:{href:e.route("profile.billing.invoices.pdf",r.id)}},[e._v("Download")])])],1)}),1)],1):e._e()],1)])])],1)],1)],1)},M=[],q=E(R,L,M,!1,null,null,null,null);const Ve=q.exports;export{Ve as default};
