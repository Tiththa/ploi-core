import i from"./TopBar.2e057c1e.js";import n from"./Container.f87d9f62.js";import s from"./Content.e22a1fd6.js";import a from"./Page.3927bdbf.js";import l from"./PageHeader.a5f457a5.js";import m from"./PageHeaderTitle.3ed783af.js";import u from"./PageBody.dec1fae1.js";import c from"./Button.f17dffc9.js";import f from"./List.d5d221b1.js";import p from"./ListItem.ee1e88fb.js";import d from"./StatusBubble.4f1d8322.js";import v from"./NotificationBadge.b6fae3d5.js";import h from"./MainLayout.32034cd8.js";import y from"./SettingsLayout.3305573b.js";import _ from"./SettingsSegment.e8fdfb41.js";import b from"./FormInput.7debc7c5.js";import g from"./Form.2cdcadd9.js";import C from"./Pagination.a93b6f75.js";import x from"./EmptyImage.4bfdf9ac.js";import k from"./FormActions.83ccca91.js";import{u as $}from"./notification.2c23a76c.js";import{u as T}from"./confirm.de1ba996.js";import q from"./Tabs.d2cdbef6.js";import P from"./Table.5d32c28c.js";import w from"./TableHead.1eed799b.js";import I from"./TableHeader.44bdf327.js";import S from"./TableRow.6382a60a.js";import j from"./TableBody.c78326a3.js";import B from"./TableData.c69a64ca.js";import{n as F}from"./plugin-vue2_normalizer.000ba15c.js";import"./TopBar.27b84f08.js";import"./Dropdown.d1060583.js";import"./DropdownList.02c48c2f.js";import"./DropdownListItem.ac31464c.js";import"./IconMoon.ade3e41b.js";import"./IconSun.8809e5d7.js";import"./IconSearch.27dac870.js";import"./IconButton.eadc8d3d.js";import"./Breadcrumbs.d39e2491.js";import"./BreadcrumbsItem.da3f8155.js";import"./TopBarTabBarContainer.3bdb2bb3.js";import"./TabBar.c1d45ed5.js";import"./TabBarItem.e9886f0a.js";import"./Confirm.888708f1.js";import"./Notification.d432029f.js";import"./IconDanger.2f6e115d.js";import"./IconWarning.ca92fb65.js";import"./IconSuccess.09b85716.js";import"./IconInfo.ad7662f9.js";import"./SearchPalette.282fdde5.js";import"./app.afed1c99.js";import"./FormGroup.efd02a6a.js";import"./Label.9d0d3ee0.js";import"./ErrorText.b141a597.js";import"./HelperText.14a7ed0b.js";import"./IconClipboard.8551be1b.js";import"./IconKey.455a255f.js";const H={metaInfo(){return{title:`Cronjobs - ${this.site.domain}`}},layout:h,components:{TopBar:i,Container:n,Content:s,Page:a,PageHeader:l,PageHeaderTitle:m,PageBody:u,Button:c,List:f,ListItem:p,StatusBubble:d,NotificationBadge:v,FormInput:b,SettingsLayout:y,SettingsSegment:_,Form:g,FormActions:k,Pagination:C,Tabs:q,Table:P,TableHead:w,TableHeader:I,TableRow:S,TableBody:j,TableData:B,EmptyImage:x},data(){return{sending:!1,form:{command:`php /home/${this.$page.props.auth.user.user_name}/${this.site.domain}/script.php`,interval:"minutely",frequency:"* * * * *"},breadcrumbs:[{title:this.$page.props.settings.name,to:"/"},{title:this.__("Sites"),to:this.route("sites.index")},{title:this.site.domain,to:this.route("sites.show",this.site.id)},{title:this.__("Cronjobs"),to:this.route("sites.cronjobs.index",this.site.id)}]}},mounted(){this.shouldBePolling&&this.startPollingInterval()},watch:{shouldBePolling:function(o){if(!o){this.clearPollingInterval();return}this.pollingInterval||this.startPollingInterval()}},computed:{shouldBePolling(){return!!this.cronjobs.data.filter(o=>o.status==="busy").length},convertedFrequency:function(){return this.form.interval==="minutely"?this.form.frequency="* * * * *":this.form.interval==="hourly"?this.form.frequency="0 * * * *":this.form.interval==="nightly"?this.form.frequency="0 2 * * *":this.form.interval==="weekly"?this.form.frequency="0 0 * * 0":this.form.interval==="monthly"?this.form.frequency="0 0 1 * *":this.form.frequency}},props:{site:Object,cronjobs:Object},methods:{useNotification:$,startPollingInterval(){this.pollingInterval=setInterval(function(){this.poll()}.bind(this),3e3)},clearPollingInterval(){clearTimeout(this.pollingInterval),this.pollingInterval=null},poll(){this.$inertia.get(this.route("sites.cronjobs.index",this.site.id),{only:["cronjobs"],preserveScroll:!0})},submit(){this.sending=!0,this.$inertia.post(this.route("sites.cronjobs.store",this.site.id),this.form,{onFinish:()=>{this.sending=!1,Object.keys(this.$page.props.errors).length||(this.form={command:`php /home/${this.$page.props.auth.user.user_name}/${this.site.domain}/script.php`,interval:"minutely",frequency:"* * * * *"})}})},confirmDelete(o){T({title:this.__("Are you sure?"),message:this.__("Your cronjob will be deleted permanently, this action cannot be undone."),onConfirm:()=>this.delete(o)})},delete(o){this.$inertia.delete(this.route("sites.cronjobs.delete",[this.site.id,o.id]),{preserveScroll:!0})}},beforeDestroy(){this.clearPollingInterval()}};var D=function(){var e=this,t=e._self._c;return t("Page",[t("TopBar",{attrs:{breadcrumbs:e.breadcrumbs}}),t("Content",[t("Container",[t("PageHeader",{scopedSlots:e._u([{key:"start",fn:function(){return[t("PageHeaderTitle",[e._v("Cronjobs")])]},proxy:!0}])}),t("PageBody",[t("SettingsLayout",{scopedSlots:e._u([{key:"nav",fn:function(){return[t("Tabs",{attrs:{site:e.site}})]},proxy:!0},{key:"segments",fn:function(){return[t("SettingsSegment",{scopedSlots:e._u([{key:"title",fn:function(){return[e._v(e._s(e.__("Create")))]},proxy:!0},{key:"subtitle",fn:function(){return[e._v(" "+e._s(e.__("Add a new cronjob here to run your background tasks with."))+" ")]},proxy:!0},{key:"form",fn:function(){return[t("form",{staticClass:"space-y-4",on:{submit:function(r){return r.preventDefault(),e.submit.apply(null,arguments)}}},[t("FormInput",{attrs:{label:e.__("Command"),errors:e.$page.props.errors.command},model:{value:e.form.command,callback:function(r){e.$set(e.form,"command",r)},expression:"form.command"}}),t("div",[t("label",{staticClass:"inline-block text-small font-medium"},[e._v(" Frequency ("+e._s(e.convertedFrequency)+") ")]),t("div",[t("label",{staticClass:"inline-flex items-center"},[t("input",{directives:[{name:"model",rawName:"v-model",value:e.form.interval,expression:"form.interval"}],staticClass:"form-radio",attrs:{type:"radio",value:"minutely"},domProps:{checked:e._q(e.form.interval,"minutely")},on:{change:function(r){return e.$set(e.form,"interval","minutely")}}}),t("span",{staticClass:"ml-2"},[e._v("Every minute")])])]),t("div",[t("label",{staticClass:"inline-flex items-center"},[t("input",{directives:[{name:"model",rawName:"v-model",value:e.form.interval,expression:"form.interval"}],staticClass:"form-radio",attrs:{type:"radio",name:"radio",value:"hourly"},domProps:{checked:e._q(e.form.interval,"hourly")},on:{change:function(r){return e.$set(e.form,"interval","hourly")}}}),t("span",{staticClass:"ml-2"},[e._v("Hourly")])])]),t("div",[t("label",{staticClass:"inline-flex items-center"},[t("input",{directives:[{name:"model",rawName:"v-model",value:e.form.interval,expression:"form.interval"}],staticClass:"form-radio",attrs:{type:"radio",name:"radio",value:"nightly"},domProps:{checked:e._q(e.form.interval,"nightly")},on:{change:function(r){return e.$set(e.form,"interval","nightly")}}}),t("span",{staticClass:"ml-2"},[e._v("Nightly (2AM)")])])]),t("div",[t("label",{staticClass:"inline-flex items-center"},[t("input",{directives:[{name:"model",rawName:"v-model",value:e.form.interval,expression:"form.interval"}],staticClass:"form-radio",attrs:{type:"radio",name:"radio",value:"weekly"},domProps:{checked:e._q(e.form.interval,"weekly")},on:{change:function(r){return e.$set(e.form,"interval","weekly")}}}),t("span",{staticClass:"ml-2"},[e._v("Weekly")])])]),t("div",[t("label",{staticClass:"inline-flex items-center"},[t("input",{directives:[{name:"model",rawName:"v-model",value:e.form.interval,expression:"form.interval"}],staticClass:"form-radio",attrs:{type:"radio",name:"radio",value:"monthly"},domProps:{checked:e._q(e.form.interval,"monthly")},on:{change:function(r){return e.$set(e.form,"interval","monthly")}}}),t("span",{staticClass:"ml-2"},[e._v("Monthly")])])]),t("div",[t("label",{staticClass:"inline-flex items-center"},[t("input",{directives:[{name:"model",rawName:"v-model",value:e.form.interval,expression:"form.interval"}],staticClass:"form-radio",attrs:{type:"radio",name:"radio",value:"custom"},domProps:{checked:e._q(e.form.interval,"custom")},on:{change:function(r){return e.$set(e.form,"interval","custom")}}}),t("span",{staticClass:"ml-2"},[e._v("Custom")])])]),t("FormInput",{directives:[{name:"show",rawName:"v-show",value:e.form.interval==="custom",expression:"form.interval === 'custom'"}],attrs:{"helper-text":"min | hour | day/month | month | day/week",errors:e.$page.props.errors.frequency,label:e.__("Custom frequency")},model:{value:e.form.frequency,callback:function(r){e.$set(e.form,"frequency",r)},expression:"form.frequency"}})],1),t("FormActions",[t("Button",[e._v(e._s(e.__("Save")))])],1)],1)]},proxy:!0}])}),e.cronjobs.meta.total?e._e():t("EmptyImage"),e.cronjobs.meta.total?t("SettingsSegment",{scopedSlots:e._u([{key:"title",fn:function(){return[e._v(e._s(e.__("Cronjobs")))]},proxy:!0},{key:"content",fn:function(){return[t("div",[t("Table",{attrs:{caption:"Cronjob list overview"}},[t("TableHead",[t("TableRow",[t("TableHeader"),t("TableHeader",[e._v(e._s(e.__("Command")))]),t("TableHeader",[e._v(e._s(e.__("Frequency")))]),t("TableHeader")],1)],1),t("TableBody",e._l(e.cronjobs.data,function(r){return t("TableRow",{key:r.id},[t("TableData",[t("StatusBubble",{attrs:{variant:r.status==="busy"?"gray":"success"}})],1),t("TableData",[e._v(e._s(r.command))]),t("TableData",[e._v(e._s(r.frequency))]),t("TableData",[t("Button",{attrs:{disabled:r.status==="busy",variant:"danger",size:"sm"},on:{click:function(L){return e.confirmDelete(r)}}},[e._v(" "+e._s(e.__("Delete"))+" ")])],1)],1)}),1)],1)],1),t("pagination",{attrs:{links:e.cronjobs}})]},proxy:!0}],null,!1,2144812964)}):e._e()]},proxy:!0}])})],1)],1)],1)],1)},N=[],A=F(H,D,N,!1,null,null,null,null);const Oe=A.exports;export{Oe as default};
