import l from"./TopBar.2e057c1e.js";import a from"./Container.f87d9f62.js";import m from"./Content.e22a1fd6.js";import p from"./Page.3927bdbf.js";import u from"./PageHeader.a5f457a5.js";import c from"./PageHeaderTitle.3ed783af.js";import f from"./PageBody.dec1fae1.js";import d from"./Button.f17dffc9.js";import _ from"./List.d5d221b1.js";import v from"./ListItem.ee1e88fb.js";import h from"./StatusBubble.4f1d8322.js";import g from"./NotificationBadge.b6fae3d5.js";import y from"./MainLayout.32034cd8.js";import I from"./EmptyImage.4bfdf9ac.js";import b from"./IconBox.e6c961ac.js";import x from"./IconGlobe.07030b80.js";import P from"./IconStorage.ef2b2e41.js";import w from"./IconButton.eadc8d3d.js";import k from"./IconMore.eb5410da.js";import C from"./IconPhp.bf31d2c3.js";import S from"./Modal.a59fc373.js";import B from"./ModalContainer.51de3ea9.js";import D from"./FormInput.7debc7c5.js";import $ from"./FormSelect.6e35ae7d.js";import L from"./FormActions.83ccca91.js";import O from"./Dropdown.d1060583.js";import M from"./DropdownList.02c48c2f.js";import F from"./DropdownListItem.ac31464c.js";import j from"./DropdownListItemButton.13731730.js";import{u as T}from"./confirm.de1ba996.js";import H from"./Pagination.a93b6f75.js";import{n as A}from"./plugin-vue2_normalizer.000ba15c.js";import"./TopBar.27b84f08.js";import"./IconMoon.ade3e41b.js";import"./IconSun.8809e5d7.js";import"./IconSearch.27dac870.js";import"./Breadcrumbs.d39e2491.js";import"./BreadcrumbsItem.da3f8155.js";import"./TopBarTabBarContainer.3bdb2bb3.js";import"./TabBar.c1d45ed5.js";import"./TabBarItem.e9886f0a.js";import"./Confirm.888708f1.js";import"./Notification.d432029f.js";import"./IconDanger.2f6e115d.js";import"./IconWarning.ca92fb65.js";import"./IconSuccess.09b85716.js";import"./IconInfo.ad7662f9.js";import"./SearchPalette.282fdde5.js";import"./notification.2c23a76c.js";import"./app.afed1c99.js";import"./IconClose.edb7c8fd.js";import"./Form.2cdcadd9.js";import"./FormGroup.efd02a6a.js";import"./Label.9d0d3ee0.js";import"./ErrorText.b141a597.js";import"./HelperText.14a7ed0b.js";import"./IconClipboard.8551be1b.js";import"./IconKey.455a255f.js";const E={metaInfo(){return{title:`${this.__("Sites")}`}},layout:y,components:{TopBar:l,Container:a,Content:m,Page:p,PageHeader:u,PageHeaderTitle:c,PageBody:f,Button:d,List:_,IconButton:w,IconMore:k,IconPhp:C,ListItem:v,StatusBubble:h,NotificationBadge:g,EmptyImage:I,IconBox:b,IconGlobe:x,IconStorage:P,Modal:S,ModalContainer:B,FormInput:D,FormActions:L,FormSelect:$,Dropdown:O,DropdownList:M,DropdownListItem:F,DropdownListItemButton:j,Pagination:H},props:{sites:Object,availableServers:[Array,Object]},computed:{shouldBePolling(){return!!this.sites.data.filter(o=>o.status==="busy").length}},mounted(){if(this.shouldBePolling&&this.startPollingInterval(),window.location.search.includes("create=")&&(this.modalIsOpen=!0),window.location.search.includes("server=")){let o=new URLSearchParams(window.location.search);this.form.server_id=o.get("server")}},watch:{shouldBePolling:function(o){if(!o){this.clearPollingInterval();return}this.pollingInterval||this.startPollingInterval()}},data(){return{form:{domain:null,server_id:null},pollingInterval:null,modalIsOpen:!1,breadcrumbs:[{title:this.$page.props.settings.name,to:"/"},{title:this.__("Sites"),to:this.route("sites.index")}]}},methods:{startPollingInterval(){this.pollingInterval=setInterval(function(){this.poll()}.bind(this),3e3)},clearPollingInterval(){clearTimeout(this.pollingInterval),this.pollingInterval=null},poll(){this.$inertia.replace(this.route("sites.index"),{only:["sites"],preserveScroll:!0})},closeModal(){this.modalIsOpen=!1,this.form.domain=null,this.$page.props.errors=[]},submit(){this.$inertia.post(this.route("sites.store"),this.form,{only:["errors","flash","sites"],onFinish:()=>{Object.keys(this.$page.props.errors).length||(this.form.domain=null,this.form.server_id=null,this.modalIsOpen=!1)}})},confirmDelete(o){T({title:this.__("Are you sure?"),message:this.__("Your site will be deleted completely, this action is irreversible."),onConfirm:()=>this.delete(o)})},delete(o){this.$inertia.delete(this.route("sites.delete",o.id))}},beforeDestroy(){this.clearPollingInterval()}};var R=function(){var t=this,e=t._self._c;return e("Page",[t.can("sites","create")?e("Portal",{attrs:{to:"modals"}},[e("ModalContainer",[t.modalIsOpen?e("Modal",{on:{close:t.closeModal,submit:t.submit},scopedSlots:t._u([{key:"title",fn:function(){return[t._v(t._s(t.__("Create a site")))]},proxy:!0},{key:"form",fn:function(){return[e("FormInput",{attrs:{label:t.__("Domain"),errors:t.$page.props.errors.domain},model:{value:t.form.domain,callback:function(r){t.$set(t.form,"domain",r)},expression:"form.domain"}}),Object.keys(t.availableServers).length?e("FormSelect",{attrs:{label:t.__("Select server")},model:{value:t.form.server_id,callback:function(r){t.$set(t.form,"server_id",r)},expression:"form.server_id"}},[e("option",{domProps:{value:`${null}`}},[t._v(t._s(t.__("Select random server")))]),t._l(t.availableServers,function(r,i){return e("option",{domProps:{value:i,textContent:t._s(r)}})})],2):t._e()]},proxy:!0},{key:"form-actions",fn:function(){return[e("Button",{domProps:{textContent:t._s(t.__("Create"))}})]},proxy:!0}],null,!1,711881564)}):t._e()],1)],1):t._e(),e("TopBar",{attrs:{breadcrumbs:t.breadcrumbs}}),e("Content",[e("Container",[e("PageHeader",{scopedSlots:t._u([{key:"start",fn:function(){return[e("PageHeaderTitle",[t._v(t._s(t.__("Sites")))])]},proxy:!0},t.can("sites","create")?{key:"end",fn:function(){return[e("Button",{on:{click:function(r){t.modalIsOpen=!0}}},[t._v(t._s(t.__("Create site")))])]},proxy:!0}:null],null,!0)}),e("PageBody",[t.sites.meta.total?t._e():e("EmptyImage"),e("List",t._l(t.sites.data,function(r){return e("ListItem",{key:r.id,scopedSlots:t._u([{key:"prefix",fn:function(){return[e("StatusBubble",{attrs:{variant:r.status==="busy"?"gray":"success"}})]},proxy:!0},{key:"title",fn:function(){return[e("inertia-link",{staticClass:"text-primary font-medium",attrs:{href:t.route("sites.show",r.id)}},[t._v(" "+t._s(r.domain)+" ")])]},proxy:!0},{key:"subtitle",fn:function(){return[e("div",{staticClass:"flex items-center space-x-2"},[e("div",{staticClass:"flex items-center space-x-2"},[e("span",[e("icon-php")],1),e("span",[t._v(t._s(r.php_version))])]),r.project==="wordpress"?e("div",[t._v("\xB7")]):t._e(),r.project==="wordpress"?e("div",[t._v(t._s(t.__("WordPress installed")))]):t._e(),r.server?e("div",[t._v("\xB7")]):t._e(),r.server?e("div",[t._v(t._s(t.__("On server"))+" "+t._s(r.server.name))]):t._e()])]},proxy:!0},{key:"suffix",fn:function(){return[e("Dropdown",{scopedSlots:t._u([{key:"default",fn:function({isOpen:i,toggle:s,position:n}){return[e("IconButton",{on:{click:s}},[e("IconMore",{staticClass:"w-5 h-5"})],1),i?e("DropdownList",{attrs:{position:n}},[e("DropdownListItem",{attrs:{to:t.route("sites.show",r.id)}},[t._v(t._s(t.__("View")))]),t.can("sites","delete")?e("DropdownListItemButton",{staticClass:"!text-danger",on:{click:function(N){return t.confirmDelete(r)}}},[t._v(t._s(t.__("Delete")))]):t._e()],1):t._e()]}}],null,!0)})]},proxy:!0}],null,!0)})}),1),e("pagination",{attrs:{links:t.sites}})],1)],1)],1)],1)},z=[],G=A(E,R,z,!1,null,null,null,null);const qt=G.exports;export{qt as default};
